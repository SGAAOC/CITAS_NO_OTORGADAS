<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CITAS NO OTORGADAS</title>
<style>
  :root{
    --blue:#0077c8;
    --blue-dark:#005c99;
    --light:#f5fbff;
    --border:#b4c9e7;
    --success:#28a745;
    --success-light:#e8f5e9;
    --error:#e74c3c;
    --error-light:#fef6f6;
    --warning:#ffeb3b;
    --warning-dark:#f2b400;
    --focus:#4fc3f7;
    --card-bg:#fff;
  }
  *{box-sizing:border-box}
  body{
    font-family: Arial, sans-serif;
    background: linear-gradient(180deg,#e8f1fb,#f8fbff);
    margin:0;
    padding:20px;
    display:flex;
    justify-content:center;
  }
  .wrapper{ width:100%; max-width:880px; }
  header{ text-align:center; margin-bottom:14px; }
  header h1{
    background:var(--blue);
    color:white;
    margin:0;
    padding:14px 18px;
    border-radius:8px;
    letter-spacing:0.6px;
    font-size:20px;
  }
  .card{
    background: var(--card-bg);
    border-radius:10px;
    box-shadow:0 6px 24px rgba(0,0,0,0.08);
    padding:18px;
    border-top:6px solid var(--blue);
  }
  label{ display:block; margin-top:12px; font-weight:700; color:#003b6f; }
  input, select, textarea, .registro {
    width:100%;
    padding:10px;
    margin-top:6px;
    border-radius:8px;
    border:2px solid var(--border);
    font-size:14px;
    text-transform:uppercase;
    background:white;
    transition: all 0.25s ease;
  }
  .registro{
    text-align:center;
    background:var(--light);
    font-weight:700;
    color:var(--blue);
    font-size:15px;
    position: relative;
    padding-left:28px;
  }
  .registro::before {
    content: "üïí";
    position: absolute;
    left: 8px;
    top: 50%;
    transform: translateY(-50%);
    animation: rotateClock 20s linear infinite;
  }
  @keyframes rotateClock {
    from { transform: translateY(-50%) rotate(0deg); }
    to { transform: translateY(-50%) rotate(360deg); }
  }
  .row{ display:flex; gap:12px; align-items:flex-end; margin-top:6px; }
  .col{ flex:1; }
  .small-btn{
    display:inline-block;
    margin-top:8px;
    padding:6px 10px;
    border-radius:6px;
    font-size:12px;
    cursor:pointer;
    border:none;
    transition: all 0.2s ease;
  }
  .small-btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 3px 6px rgba(0,0,0,0.12);
  }
  .fixed{ background:var(--blue); color:white; }
  .notfixed{ background:var(--border); color:#073a6a; }
  .fijado-label{ font-size:12px; color:var(--blue); margin-top:6px; font-weight:700; display:none; }
  .fijado-visible{ display:block; }
  .check{ color:var(--success); font-size:18px; margin-left:8px; display:none; vertical-align:middle;}
  .check.visible{ 
    display:inline-block; 
    animation: pop .28s ease-out, bounce 0.6s 0.2s ease;
  }
  @keyframes pop{ from{transform:scale(0);} to{transform:scale(1);} }
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-4px); }
  }
  .btns{ display:flex; gap:10px; margin-top:12px; }
  .btn{ 
    flex:1; 
    padding:10px; 
    background:var(--blue); 
    color:white; 
    border:none; 
    border-radius:8px; 
    font-weight:700; 
    cursor:pointer; 
    position: relative;
    overflow: hidden;
    transition: all 0.2s ease;
  }
  .btn:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 10px rgba(0,59,111,0.25);
  }
  .btn.secondary{ background:var(--blue-dark); }
  textarea{ 
    min-height:72px; 
    resize:vertical; 
    text-transform:uppercase;
    transition: all 0.2s ease;
  }
  textarea:focus {
    box-shadow: 0 0 0 2px var(--focus) !important;
  }
  .note{ font-size:12px; color:#456; margin-top:6px; }

  /* ‚úÖ ESTILOS MEJORADOS */
  input:focus, select:focus {
    border-color: var(--focus) !important;
    box-shadow: 0 0 0 2px rgba(79, 195, 247, 0.3) !important;
    outline: none;
  }

  .success {
    border-color: var(--success) !important;
    background-color: var(--success-light) !important;
    box-shadow: 0 0 0 2px rgba(40, 167, 69, 0.15) !important;
    animation: pulseSuccess 0.6s ease-out;
  }
  @keyframes pulseSuccess {
    0% { box-shadow: 0 0 0 0 rgba(40,167,69,0.4); }
    70% { box-shadow: 0 0 0 8px rgba(40,167,69,0); }
    100% { box-shadow: 0 0 0 0 rgba(40,167,69,0); }
  }

  .incomplete {
    border-color: var(--warning-dark) !important;
    background-color: rgba(255, 235, 59, 0.08) !important;
    box-shadow: 0 0 0 2px rgba(242, 180, 0, 0.1) !important;
  }

  .error-field {
    border-color: var(--error) !important;
    background-color: var(--error-light) !important;
    box-shadow: 0 0 0 2px rgba(231, 76, 60, 0.15) !important;
  }

  .status-msg {
    font-size: 11px;
    margin-top: 4px;
    padding: 4px 8px;
    border-radius: 4px;
    font-weight: 600;
    display: inline-block;
    animation: fadeIn 0.3s ease-out;
  }
  .status-msg.success { background: var(--success-light); color: var(--success); }
  .status-msg.warning { background: rgba(255, 235, 59, 0.2); color: var(--warning-dark); }
  .status-msg.error { background: var(--error-light); color: var(--error); }
  @keyframes fadeIn { from { opacity:0; transform: translateY(-3px); } to { opacity:1; transform: translateY(0); } }

  .status-msg::before {
    margin-right: 4px;
    font-weight: bold;
  }
  .status-msg.success::before { content: "‚úî"; }
  .status-msg.warning::before { content: "‚ö†"; }
  .status-msg.error::before { content: "‚úò"; }

  /* üì§ Loader al guardar */
  .btn.loading {
    cursor: not-allowed;
    opacity: 0.8;
    position: relative;
  }
  .btn.loading::after {
    content: '';
    position: absolute;
    top: 50%; left: 50%;
    width: 16px; height: 16px;
    margin: -8px 0 0 -8px;
    border: 2px solid transparent;
    border-top-color: white;
    border-radius: 50%;
    animation: spin 1s linear infinite;
  }
  @keyframes spin { to { transform: rotate(360deg); } }

  @media (max-width:640px){ 
    .row{ flex-direction:column; } 
    .registro::before { animation: none; }
  }

  /* üîç ESTILOS DEL BUSCADOR */
  .search-container {
    position: relative;
    margin-top: 6px;
  }
  .search-input {
    width: 100%;
    padding: 8px 12px;
    border: 2px solid var(--border);
    border-radius: 8px;
    font-size: 14px;
    text-transform: uppercase;
    background: white;
    margin-bottom: 8px;
    z-index: 10;
    position: relative;
  }
  .search-results {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background: white;
    border: 2px solid var(--border);
    border-top: none;
    border-radius: 0 0 8px 8px;
    max-height: 200px;
    overflow-y: auto;
    z-index: 9;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
  }
  .search-result-item {
    padding: 8px 12px;
    cursor: pointer;
    transition: background-color 0.2s;
    text-transform: uppercase;
  }
  .search-result-item:hover {
    background-color: var(--light);
  }
  .search-result-item.selected {
    background-color: var(--blue);
    color: white;
  }
  .search-no-results {
    padding: 8px 12px;
    color: #777;
    text-align: center;
  }
  .search-icon {
    position: absolute;
    left: 10px;
    top: 50%;
    transform: translateY(-50%);
    color: #777;
    pointer-events: none;
  }
  .search-input-wrapper {
    position: relative;
  }
  .search-input-wrapper input {
    padding-left: 30px;
  }
</style>
</head>
<body>
<div class="wrapper">
  <header>
    <h1>DEMANDA DE CITAS NO OTORGADAS</h1>
  </header>

  <div class="card">

    <label>REGISTRO (Fecha y Hora)</label>
    <div id="registro" class="registro" aria-live="polite"></div>

    <div class="row" style="margin-top:10px;">
      <div class="col">
        <label>AGENTE *</label>
        <div id="agente-search-container" class="search-container">
          <div class="search-input-wrapper">
            <span class="search-icon">üîç</span>
            <input type="text" id="agente-search" class="search-input" placeholder="Buscar agente..." autocomplete="off" />
          </div>
          <select id="agente" style="display: none;">
            <option value="">Seleccione un agente...</option>


            
<option value="71412-ADANAQUE JUAREZ ROSA ARACELY">ADANAQUE JUAREZ ROSA ARACELY</option>
<option value="29793-AGUERO SOLANO RAQUEL URSULA">AG√úERO SOLANO RAQUEL URSULA</option>
<option value="64863-AGUILA MILLONES CARMEN ELIZABETH">AGUILA MILLONES CARMEN ELIZABETH</option>
<option value="79932-AHUMADA LLANOS ALVARO ALBERTO">AHUMADA LLANOS ALVARO ALBERTO</option>
<option value="77506-ALARCON GILRALDO PILAR">ALARCON GILRALDO PILAR</option>
<option value="80989-ALARCON MOGOLLON KAREN JACKELINE">ALARCON MOGOLLON KAREN JACKELINE</option>
<option value="73820-ALARCON SUELDO CLAUDIA CAMILA">ALARCON SUELDO CLAUDIA CAMILA</option>
<option value="74217-ALDERETE ARCOS MIRIAN ESTEFANI">ALDERETE ARCOS MIRIAN ESTEFANI</option>
<option value="73954-ALVAREZ ATILANO MARTHA ESMERALDA">ALVAREZ ATILANO MARTHA ESMERALDA</option>
<option value="76358-ALVAREZ LUDE√ëA GINO ANDREI">ALVAREZ LUDE√ëA GINO ANDREI</option>
<option value="59797-ALVAREZ SANCHEZ JOSE ANTONIO">ALVAREZ SANCHEZ JOSE ANTONIO</option>
<option value="80642-AMAHUANCA AGUERO EFRAIN EUGENIO">AMAHUANCA AG√úERO EFRAIN EUGENIO</option>
<option value="80453-AMANQUI CHARCA PAOLO CESAR ORLANDO">AMANQUI CHARCA PAOLO CESAR ORLANDO</option>
<option value="80169-AMANQUI PAREDES SONIA">AMANQUI PAREDES SONIA</option>
<option value="59692-AMAYA HUARCAYA LIZBETH CINDIA">AMAYA HUARCAYA LIZBETH CINDIA</option>
<option value="73143-ANGELES SA√ëAC GEILY LOURDES">ANGELES SA√ëAC GEILY LOURDES</option>
<option value="22944-ARANA CHAVEZ MARITZA LUZ">ARANA CHAVEZ MARITZA LUZ</option>
<option value="59797-ARAUJO PULIDO MARIA ISABEL">ARAUJO PULIDO MARIA ISABEL</option>
<option value="75259-AREVALO ODAR MILAGROS AREI">AREVALO ODAR MILAGROS AREI</option>
<option value="69955-ARREDONDO NAVARRO HANS RICARDO">ARREDONDO NAVARRO HANS RICARDO</option>
<option value="66481-ARRIOLA VASQUEZ AURORA ISABEL">ARRIOLA VASQUEZ AURORA ISABEL</option>
<option value="79843-ARTEAGA SANCHEZ ANGHELI SAORI">ARTEAGA SANCHEZ ANGHELI SAORI</option>
<option value="73915-ASENCIO VEGA PERCY EDU">ASENCIO VEGA PERCY EDU</option>
<option value="78809-ASTOCONDOR CALDAS JENNIFER MILAGRITOS">ASTOCONDOR CALDAS JENNIFER MILAGRITOS</option>
<option value="75064-AVELLANEDA NAVARRO ADRIAN JACOB RAUL">AVELLANEDA NAVARRO ADRIAN JACOB RAUL</option>
<option value="26097-AVILES OJEDA IRMA">AVILES OJEDA IRMA</option>
<option value="71065-BALLADARES SHUPINGAHUA JOSE LUIS FERNANDO">BALLADARES SHUPINGAHUA JOSE LUIS FERNANDO</option>
<option value="70804-BARREDA VALDIVIA DIANA ELIZABETH">BARREDA VALDIVIA DIANA ELIZABETH</option>
<option value="80265-BARRENECHEA PORRAS KATHERINE DEL CARMEN">BARRENECHEA PORRAS KATHERINE DEL CARMEN</option>
<option value="80133-BARRIENTOS VILLANUEVA DORITA DEL PILAR">BARRIENTOS VILLANUEVA DORITA DEL PILAR</option>
<option value="37055-BAUTISTA DAMIAN MANUELA">BAUTISTA DAMIAN MANUELA</option>
<option value="77569-BAZAN REA√ëO MIGUEL ANGEL">BAZAN REA√ëO MIGUEL ANGEL</option>
<option value="42101-BAZAN TORRES GLADYS">BAZAN TORRES GLADYS</option>
<option value="76303-BECERRA FLORES JOSE SANTOS GLENN">BECERRA FLORES JOSE SANTOS GLENN</option>
<option value="64581-BELTRAN SEMINARIO CYNTHIA ALEJANDRA">BELTRAN SEMINARIO CYNTHIA ALEJANDRA</option>
<option value="63949-BERNACHEA BLAS EVELYN XIOMARA">BERNACHEA BLAS EVELYN XIOMARA</option>
<option value="63634-BERNALDO CANTARO LISBETH CATHERINE">BERNALDO CANTARO LISBETH CATHERINE</option>
<option value="70971-CABANILLAS ESQUEN SANDRA ESTEFANY">CABANILLAS ESQUEN SANDRA ESTEFANY</option>
<option value="81056-CADENAS ARANDA VICTOR VICENTE">CADENAS ARANDA VICTOR VICENTE</option>
<option value="74305-CAHUANA GARCIA AIRAM ANDREA DEL MAR">CAHUANA GARCIA AIRAM ANDREA DEL MAR</option>
<option value="70783-CALDERON CABANILLAS JULY SOLEDAD">CALDERON CABANILLAS JULY SOLEDAD</option>
<option value="73675-CALDERON SALAZAR CARMEN ROS">CALDERON SALAZAR CARMEN ROS</option>
<option value="64493-CALDERON SOTO NATHALY DE LAS NIEVES">CALDERON SOTO NATHALY DE LAS NIEVES</option>
<option value="64316-CAMACHO PAREDES ANDREINA PILAR">CAMACHO PAREDES ANDREINA PILAR</option>
<option value="53377-CAMASSI SALDA√ëA PATRICIA TATIANA">CAMASSI SALDA√ëA PATRICIA TATIANA</option>
<option value="70875-CAMPOS AVILA ROBERTO JORGE">CAMPOS AVILA ROBERTO JORGE</option>
<option value="78730-CAMPOS SONO LIZ MARIELLA">CAMPOS SONO LIZ MARIELLA</option>
<option value="67765-CARDENAS AQUINO MARIANA JAZMIN">CARDENAS AQUINO MARIANA JAZMIN</option>
<option value="78917-CARDENAS CHOQUE ANGIE IZUMI">CARDENAS CHOQUE ANGIE IZUMI</option>
<option value="64417-CARDENAS RIOJAS KARIN LORENA">CARDENAS RIOJAS KARIN LORENA</option>
<option value="76220-CARPIO CABALLERO OFELIA JULIA">CARPIO CABALLERO OFELIA JULIA</option>
<option value="73201-CARPIO PINEDA JORGE VICTOR">CARPIO PINEDA JORGE VICTOR</option>
<option value="64199-CARRASCO SUDARIO JORGE">CARRASCO SUDARIO JORGE</option>
<option value="73124-CARRION SANTOS OSCAR MARTIN">CARRION SANTOS OSCAR MARTIN</option>
<option value="80202-CASIANO PARIONA MELANIE LIZETH">CASIANO PARIONA MELANIE LIZETH</option>
<option value="43058-CASTILLO CARRASCO ROMAN">CASTILLO CARRASCO ROMAN</option>
<option value="76156-CASTILLO RUIZ DENISSE LUCERO">CASTILLO RUIZ DENISSE LUCERO</option>
<option value="75872-CASTRO FUENTES STEPHANIE JAZBEL">CASTRO FUENTES STEPHANIE JAZBEL</option>
<option value="77724-CASTROMONTE CUEVA ANDREA ALEXANDRA">CASTROMONTE CUEVA ANDREA ALEXANDRA</option>
<option value="75068-CAYETANO ROJAS IVONNE FELICITA">CAYETANO ROJAS IVONNE FELICITA</option>
<option value="80103-CAYLLAHUA BENITES RICHARD BRIAN">CAYLLAHUA BENITES RICHARD BRIAN</option>
<option value="67178-CESPEDES CASTILLO LUCY NOEMI">CESPEDES CASTILLO LUCY NOEMI</option>
<option value="60028-CESPEDES FLORES PATRICIA ISABEL DE FATIMA">CESPEDES FLORES PATRICIA ISABEL DE FATIMA</option>
<option value="74840-CHACON OLIVA RENZO LEONARDO">CHACON OLIVA RENZO LEONARDO</option>
<option value="35973-CHAMORRO OSTOS JANETT CLOTILDE">CHAMORRO OSTOS JANETT CLOTILDE</option>
<option value="40939-CHANCAFE ROBLES JACQUELINE DEL ROCIO">CHANCAFE ROBLES JACQUELINE DEL ROCIO</option>
<option value="73435-CHAVARRIA SA√ëAC YERSY CRISTIAN">CHAVARRIA SA√ëAC YERSY CRISTIAN</option>
<option value="78738-CHAVEZ ORTEGA BERTHA IVONE">CHAVEZ ORTEGA BERTHA IVONE</option>
<option value="77212-CHAVEZ RAMIREZ JANET">CHAVEZ RAMIREZ JANET</option>
<option value="64300-CHAVEZ TINCO ELIO JERSON">CHAVEZ TINCO ELIO JERSON</option>
<option value="71185-CHIPANA ARIAS LUZ ELENA">CHIPANA ARIAS LUZ ELENA</option>
<option value="73149-CHIRINOS ESCARCENA KARINA NATHALY">CHIRINOS ESCARCENA KARINA NATHALY</option>
<option value="74558-CHUGNAS FIGUEROA MELANIA">CHUGNAS FIGUEROA MELANIA</option>
<option value="61835-COLLAZOS ESPINOZA LUIS ALBERTO">COLLAZOS ESPINOZA LUIS ALBERTO</option>
<option value="70070-COLONIA TIPIAN DARLING ANDERSON">COLONIA TIPIAN DARLING ANDERSON</option>
<option value="49632-CONDORI DE LA CRUZ SCARLETT ENMA">CONDORI DE LA CRUZ SCARLETT ENMA</option>
<option value="80063-CONDORI HUANCA VANESSA ANGELICA">CONDORI HUANCA VANESSA ANGELICA</option>
<option value="56041-CONDORI MAMANI MARIA PILAR">CONDORI MAMANI MARIA PILAR</option>
<option value="70980-COPERTINO GAVINO MARITZA ANGELICA">COPERTINO GAVINO MARITZA ANGELICA</option>
<option value="65968-CORAL TERRONES MIGUEL ANGEL">CORAL TERRONES MIGUEL ANGEL</option>
<option value="79942-CORDOVA BALDARRAGO ANDERSON OSWALDO">CORDOVA BALDARRAGO ANDERSON OSWALDO</option>
<option value="69952-CORDOVA LLACSA DHYAN RAJENDRA">CORDOVA LLACSA DHYAN RAJENDRA</option>
<option value="72417-CORONEL MEZA ESTEFANY LIZBETH">CORONEL MEZA ESTEFANY LIZBETH</option>
<option value="64098-CRUZ FLORES VELDIN ALIPIO">CRUZ FLORES VELDIN ALIPIO</option>
<option value="64628-CRUZ MARTINEZ LUISA CECILIA">CRUZ MARTINEZ LUISA CECILIA</option>
<option value="73173-CRUZ PORTAL DANIEL JOSE">CRUZ PORTAL DANIEL JOSE</option>
<option value="62872-CUNGIARACHE CAMASCA LILIANA LUZ">CUNGIARACHE CAMASCA LILIANA LUZ</option>
<option value="79927-CURIMANYA CCOYLLO GRECIA MARGARITA">CURIMANYA CCOYLLO GRECIA MARGARITA</option>
<option value="60289-CUYA SIMEON JULIA VICTORIA">CUYA SIMEON JULIA VICTORIA</option>
<option value="76371-CUYA VILLEGAS ALEXIS ALFREDO">CUYA VILLEGAS ALEXIS ALFREDO</option>
<option value="79598-DAMIAN DIAZ FABIAN">DAMIAN DIAZ FABIAN</option>
<option value="71938-DAVILA VEGA MARCO ANTONIO">DAVILA VEGA MARCO ANTONIO</option>
<option value="74162-DE LA CRUZ GRANADOS NATALY STEPHANIE">DE LA CRUZ GRANADOS NATALY STEPHANIE</option>
<option value="53298-DE LA CRUZ TAIPE PAULINA MINAYA">DE LA CRUZ TAIPE PAULINA MINAYA</option>
<option value="76059-DELGADO HUAMANI GINO ALEXIS">DELGADO HUAMANI GINO ALEXIS</option>
<option value="70602-DOMINGUEZ ROMERO DE MARTINEZ DIANA">DOMINGUEZ ROMERO DE MARTINEZ DIANA</option>
<option value="44925-DURAN QUISPE VERONICA VALERIA">DURAN QUISPE VERONICA VALERIA</option>
<option value="66379-ESCALANTE CASTILLO LISSET">ESCALANTE CASTILLO LISSET</option>
<option value="61194-ESCRIBA COSAVALENTE MIRIAM YANETT">ESCRIBA COSAVALENTE MIRIAM YANETT</option>
<option value="78598-ESPINO TACUNA ANDREA ISABELLA">ESPINO TACUNA ANDREA ISABELLA</option>
<option value="70985-ESPINOZA MENACHO JUAN GERARDO">ESPINOZA MENACHO JUAN GERARDO</option>
<option value="81055-ESTELA MANCO JIMMY ANTHONY">ESTELA MANCO JIMMY ANTHONY</option>
<option value="73161-ESTRADA SIPION HENRY EMERSON">ESTRADA SIPION HENRY EMERSON</option>
<option value="71036-EVARISTO BUENDIA ARACELY">EVARISTO BUENDIA ARACELY</option>
<option value="64466-EXEBIO VARGAS JANET MARIA">EXEBIO VARGAS JANET MARIA</option>
<option value="73090-FACUNDO BRUNO NICK BREMER">FACUNDO BRUNO NICK BREMER</option>
<option value="79004-FARRO PEREZ SARITA BELEN">FARRO PEREZ SARITA BELEN</option>
<option value="75761-FERNANDEZ FLORES CLAUDIA ELIZABETH">FERNANDEZ FLORES CLAUDIA ELIZABETH</option>
<option value="35974-FERNANDEZ SANTA CRUZ DE TAVARA MARIA">FERNANDEZ SANTA CRUZ DE TAVARA MARIA</option>
<option value="73335-FIGUEROA GONZALES MILAGROS">FIGUEROA GONZALES MILAGROS</option>
<option value="78704-FIGUEROA MENDOZA KATHERINE JULIET">FIGUEROA MENDOZA KATHERINE JULIET</option>
<option value="38622-FLORES BOHORQUEZ PEGGY LILIANA IVETT">FLORES BOHORQUEZ PEGGY LILIANA IVETT</option>
<option value="64091-FLORES DE LA CRUZ JOSELINE PAOLA">FLORES DE LA CRUZ JOSELINE PAOLA</option>
<option value="80032-FLORES SANCHEZ DE KARA KELLY MONICA">FLORES SANCHEZ DE KARA KELLY MONICA</option>
<option value="80154-FLORES TAFUR ROLANDO">FLORES TAFUR ROLANDO</option>
<option value="71375-FLORES VITOR MARISOL LEONILDA">FLORES VITOR MARISOL LEONILDA</option>
<option value="76067-FRANCISCO GUARNIZ EDITH">FRANCISCO GUARNIZ EDITH</option>
<option value="59534-FRANCO LIMACHI JHOSELYN SOFIA">FRANCO LIMACHI JHOSELYN SOFIA</option>
<option value="79940-FRETEL TORRES CATHERINE NICOLE">FRETEL TORRES CATHERINE NICOLE</option>
<option value="22001-GALLEGOS LARREA ROCIO JUANA">GALLEGOS LARREA ROCIO JUANA</option>
<option value="65703-GALLEGOS LOZA ROSANGELA">GALLEGOS LOZA ROSANGELA</option>
<option value="78115-GAMARRA FERNANDEZ JESUS AARON">GAMARRA FERNANDEZ JESUS AARON</option>
<option value="73794-GAMARRA TORRES JOHN EDISSON">GAMARRA TORRES JOHN EDISSON</option>
<option value="79780-GARCIA CAHUANA IVONNE JESSICA">GARCIA CAHUANA IVONNE JESSICA</option>
<option value="64164-GARCIA CAHUANA PATRICIA DEL CARMEN">GARCIA CAHUANA PATRICIA DEL CARMEN</option>
<option value="78129-GARCIA CHAMAYA CLAUDIA CAMILA">GARCIA CHAMAYA CLAUDIA CAMILA</option>
<option value="76007-GARCIA ODIAGA ALEJANDRO PAOLO">GARCIA ODIAGA ALEJANDRO PAOLO</option>
<option value="77597-GARCIA ROCA FELICIANA EUGENIA">GARCIA ROCA FELICIANA EUGENIA</option>
<option value="67930-GASGA DAVILA JHENLI">GASGA DAVILA JHENLI</option>
<option value="73228-GAYOSO ORTIZ ANDREA MARGARITA">GAYOSO ORTIZ ANDREA MARGARITA</option>
<option value="77576-GIANELLO SUAZO ANA MARIA FIORELLA">GIANELLO SUAZO ANA MARIA FIORELLA</option>
<option value="80061-GIRALDO ALVAREZ DE GUZMAN ROXANA">GIRALDO ALVAREZ DE GUZMAN ROXANA</option>
<option value="80050-GODOY BRAVO EMANUEL HORACIO">GODOY BRAVO EMANUEL HORACIO</option>
<option value="31713-GONZALES ARIAS RUBI">GONZALES ARIAS RUBI</option>
<option value="74112-GONZALES FARRO√ëAN GIOVANNA MARLENE">GONZALES FARRO√ëAN GIOVANNA MARLENE</option>
<option value="76017-GONZALES FLORES LIZBETH ROXANA">GONZALES FLORES LIZBETH ROXANA</option>
<option value="43444-GONZALES GOMEZ KARLA PAOLA">GONZALES GOMEZ KARLA PAOLA</option>
<option value="79348-GONZALES HEREDIA ALEXANDRA SUAN">GONZALES HEREDIA ALEXANDRA SUAN</option>
<option value="61281-GONZALES MARTEL JESSICA OBDULIA">GONZALES MARTEL JESSICA OBDULIA</option>
<option value="77711-GONZALES TERRONES LUZMILA DEL ROCIO">GONZALES TERRONES LUZMILA DEL ROCIO</option>
<option value="70799-GRADOS GAMARRA MILAGROS ROSARIO">GRADOS GAMARRA MILAGROS ROSARIO</option>
<option value="72678-GUERRERO CAMPOS YULY ELISABET">GUERRERO CAMPOS YULY ELISABET</option>
<option value="76404-GUERRERO MARTELL ROSALIA VANESSA">GUERRERO MARTELL ROSALIA VANESSA</option>
<option value="59012-GUEVARA ALVARADO MARILIZ">GUEVARA ALVARADO MARILIZ</option>
<option value="69949-GUILLEN OSTOS ROSA ETELVINA">GUILLEN OSTOS ROSA ETELVINA</option>
<option value="80454-GUIZADO FLORES MANOLO">GUIZADO FLORES MANOLO</option>
<option value="40341-GUTIERREZ LUYO DE NAVARRO ROSA TULIA">GUTIERREZ LUYO DE NAVARRO ROSA TULIA</option>
<option value="79931-GUZMAN FUENTES JENIFER ANALI">GUZMAN FUENTES JENIFER ANALI</option>
<option value="78286-HERNANDEZ AGUILAR JAVIER ALONSO TADEO">HERNANDEZ AGUILAR JAVIER ALONSO TADEO</option>
<option value="75598-HERRERA VERA ESTEFANO EMILIO">HERRERA VERA ESTEFANO EMILIO</option>
<option value="80745-HUALLANCA PAREDES RAQUEL MARGOT">HUALLANCA PAREDES RAQUEL MARGOT</option>
<option value="79638-HUAMAN BALDARRAGO NAYELI ROMY">HUAMAN BALDARRAGO NAYELI ROMY</option>
<option value="35633-HUAMANI ANCHANTE MARCIA MARIEL">HUAMANI ANCHANTE MARCIA MARIEL</option>
<option value="71199-HUAMANI MARTINEZ CARMEN ROSA">HUAMANI MARTINEZ CARMEN ROSA</option>
<option value="79886-HUAMANTINCO TORRES FLORENCIA ALEJANDRA">HUAMANTINCO TORRES FLORENCIA ALEJANDRA</option>
<option value="80748-HUAYLLA DE LA CRUZ ALEXIS">HUAYLLA DE LA CRUZ ALEXIS</option>
<option value="79741-HUAYLLASCO RAMOS RONALD VICTOR">HUAYLLASCO RAMOS RONALD VICTOR</option>
<option value="77945-HUAZANGA TORRES MAYLY">HUAZANGA TORRES MAYLY</option>
<option value="78157-HUINCHO CONDORI SHIRLEY DAYANA">HUINCHO CONDORI SHIRLEY DAYANA</option>
<option value="66999-HURTADO VILOGRON DE SILVA MARIA DE MONTSERRAT">HURTADO VILOGRON DE SILVA MARIA DE MONTSERRAT</option>
<option value="30017-IBARRA HUASHUAYO MILAGROS">IBARRA HUASHUAYO MILAGROS</option>
<option value="76190-IDROGO CELIZ GERALDINI ESTEFANI">IDROGO CELIZ GERALDINI ESTEFANI</option>
<option value="80587-INCHAUSTEGUI MESONES LUIS CARLOS">INCHAUSTEGUI MESONES LUIS CARLOS</option>
<option value="80010-INGA HERNANDEZ MERCEDES AMELIA">INGA HERNANDEZ MERCEDES AMELIA</option>
<option value="80191-INOCENTE ESPINOZA ALLISSON PAOLA">INOCENTE ESPINOZA ALLISSON PAOLA</option>
<option value="64193-INTI GALARZA KARINA JOANNA">INTI GALARZA KARINA JOANNA</option>
<option value="79583-JANAMPA AMAO NICOLE NAOMI">JANAMPA AMAO NICOLE NAOMI</option>
<option value="78454-JAUREGUI CONDORI ALEJANDRA">JAUREGUI CONDORI ALEJANDRA</option>
<option value="71962-JUAREZ CASTILLO DIANA VANESSA">JUAREZ CASTILTO DIANA VANESSA</option>
<option value="37422-LA ROSA RAMIREZ ELIZABETH ESTRELLA">LA ROSA RAMIREZ ELIZABETH ESTRELLA</option>
<option value="79285-LAIME GUTIERREZ MARLENE ADELINA">LAIME GUTIERREZ MARLENE ADELINA</option>
<option value="69957-LAMA BARRIAL JESSICA CYNTHIA">LAMA BARRIAL JESSICA CYNTHIA</option>
<option value="72993-LAMA BARRIAL JHOHANNY STEFANNIE">LAMA BARRIAL JHOHANNY STEFANNIE</option>
<option value="79520-LANDAVERI APAZA PAOLA MARICIELO">LANDAVERI APAZA PAOLA MARICIELO</option>
<option value="64943-LARREA RAMIREZ DAPHNE FIORELLA MILAGROS">LARREA RAMIREZ DAPHNE FIORELLA MILAGROS</option>
<option value="78077-LAURENTE LOPEZ KATHERINE ESTEFANIA">LAURENTE LOPEZ KATHERINE ESTEFANIA</option>
<option value="73895-LECERAS HUILLCA MARIA ISABEL">LECERAS HUILLCA MARIA ISABEL</option>
<option value="80751-LEON MENDOZA ABRIGAIL MARIA">LEON MENDOZA ABRIGAIL MARIA</option>
<option value="64129-LESCANO PECHE JANET TERESA">LESCANO PECHE JANET TERESA</option>
<option value="76087-LESCANO PECHE MARIA ELENA">LESCANO PECHE MARIA ELENA</option>
<option value="80731-LIMAHUAYA HALLASI MARTHA">LIMAHUAYA HALLASI MARTHA</option>
<option value="80038-LINARES CARTY OLENKA JOHANA">LINARES CARTY OLENKA JOHANA</option>
<option value="64168-LLANCARI VASQUEZ ROMINA YAMAIRA">LLANCARI VASQUEZ ROMINA YAMAIRA</option>
<option value="77662-LOO GUZMAN ALEXANDRA">LOO GUZMAN ALEXANDRA</option>
<option value="79191-LOPEZ FLORES BRAYANTS LESTER">LOPEZ FLORES BRAYANTS LESTER</option>
<option value="75414-LOPEZ VALLES INGRID MILUSKA">LOPEZ VALLES INGRID MILUSKA</option>
<option value="74032-LUMBA TIRADO NATHALY MARGOTH">LUMBA TIRADO NATHALY MARGOTH</option>
<option value="80082-LUYO MIRABAL SOFIA NATALI">LUYO MIRABAL SOFIA NATALI</option>
<option value="80940-MACHADO AGUINAGA CRISTINA AURELIA ISABEL">MACHADO AGUINAGA CRISTINA AURELIA ISABEL</option>
<option value="27238-MADUE√ëO MADUE√ëO KAREN GIOMARA">MADUE√ëO MADUE√ëO KAREN GIOMARA</option>
<option value="72788-MALASQUEZ AZA√ëA FATIMA DAYANELLA">MALASQUEZ AZA√ëA FATIMA DAYANELLA</option>
<option value="79537-MALDONADO CHUNGA SEGUNDO GRABIEL">MALDONADO CHUNGA SEGUNDO GRABIEL</option>
<option value="69843-MAMANI PAYEHUANCA ALBINA">MAMANI PAYEHUANCA ALBINA</option>
<option value="13310-MAMANI PE√ëA MAXIMIANA SOLEDAD">MAMANI PE√ëA MAXIMIANA SOLEDAD</option>
<option value="67695-MANRIQUE CHIROQUE MANUEL">MANRIQUE CHIROQUE MANUEL</option>
<option value="59421-MANRIQUE HUAMAN GIULIANNA">MANRIQUE HUAMAN GIULIANNA</option>
<option value="76740-MANSILLA HERRERA RONNY RICARDO">MANSILLA HERRERA RONNY RICARDO</option>
<option value="70074-MANTUSTHUPA SILVA FERNANDO NARCISO">MANTUSTHUPA SILVA FERNANDO NARCISO</option>
<option value="80805-MANTUSTHUPA SILVA SILVIA PAMELA">MANTUSTHUPA SILVA SILVIA PAMELA</option>
<option value="80184-MARTEL VILLAR FABIANA">MARTEL VILLAR FABIANA</option>
<option value="76274-MARTINEZ ORTIZ YESSICA JANET">MARTINEZ ORTIZ YESSICA JANET</option>
<option value="65965-MATIAS GARCIA ROSA ANTONIETA">MATIAS GARCIA ROSA ANTONIETA</option>
<option value="76566-MATOS CHAVEZ KATERIN JAZMIN">MATOS CHAVEZ KATERIN JAZMIN</option>
<option value="80197-MEJIA CA√ëOTE ROSSEMEY JACKELINE">MEJIA CA√ëOTE ROSSEMEY JACKELINE</option>
<option value="63785-MELENDEZ AGUIRRE ELAYNE MILAGROS">MELENDEZ AGUIRRE ELAYNE MILAGROS</option>
<option value="64159-MELGAREJO MEJIA KATHERINE FATIMA">MELGAREJO MEJIA KATHERINE FATIMA</option>
<option value="77622-MENDEZ QUISPE MARCOS ANTONIO">MENDEZ QUISPE MARCOS ANTONIO</option>
<option value="75842-MENDOZA SILVA ALISON">MENDOZA SILVA ALISON</option>
<option value="76069-MESONES MESONES BORIS JHON">MESONES MESONES BORIS JHON</option>
<option value="78974-MOGOLLON MARTINEZ ZOE SAMANTHA">MOGOLLON MARTINEZ ZOE SAMANTHA</option>
<option value="77637-MOGOLLON PERALTA JESUS BENJAMIN">MOGOLLON PERALTA JESUS BENJAMIN</option>
<option value="73359-MOLLO GIRON DIEGO ALONSO">MOLLO GIRON DIEGO ALONSO</option>
<option value="76410-MORALES VILLEGAS SHIRLEY RUTH">MORALES VILLEGAS SHIRLEY RUTH</option>
<option value="63242-MORE GARCIA ESTHEFANY ROSALIA">MORE GARCIA ESTHEFANY ROSALIA</option>
<option value="80990-MORE ZAVALETA ANTUANET ROSALYN">MORE ZAVALETA ANTUANET ROSALYN</option>
<option value="75293-MOREANO MALDONADO SUSAN LENY">MOREANO MALDONADO SUSAN LENY</option>
<option value="55641-MORENO ARONI CARMEN LIDIA">MORENO ARONI CARMEN LIDIA</option>
<option value="76910-MORENO FLORES CINTHYA VANESSA">MORENO FLORES CINTHYA VANESSA</option>
<option value="79380-MU√ëOZ CASTREJON MARIA DEL CARMEN">MU√ëOZ CASTREJON MARIA DEL CARMEN</option>
<option value="79388-MU√ëOZ CERDAN OLGA">MU√ëOZ CERDAN OLGA</option>
<option value="80171-NACION GUTIERREZ EDWIN WALTER">NACION GUTIERREZ EDWIN WALTER</option>
<option value="75442-NAVARRO LOAYZA MAGALLY PATRICIA">NAVARRO LOAYZA MAGALLY PATRICIA</option>
<option value="72661-NEYRA LOPEZ MIRIAM JANET">NEYRA LOPEZ MIRIAM JANET</option>
<option value="64004-NOEL NOEL MARIA JESUS">NOEL NOEL MARIA JESUS</option>
<option value="20794-NONONE CARHUAMACA EVELYN HELEN">NONONE CARHUAMACA EVELYN HELEN</option>
<option value="66468-NORIEGA RAMOS JUNIOR MANUEL">NORIEGA RAMOS JUNIOR MANUEL</option>
<option value="80083-NORIEGA VALVERDE CAROLINA ALMENDRA">NORIEGA VALVERDE CAROLINA ALMENDRA</option>
<option value="67725-NUNURA MIRANDA JACKELINE ESPERANZA">NUNURA MIRANDA JACKELINE ESPERANZA</option>
<option value="71638-NU√ëEZ OBANDO KARINA ISABEL">NU√ëEZ OBANDO KARINA ISABEL</option>
<option value="74652-√ëAHUI CANCHO MARIA CLAUDIA">√ëAHUI CANCHO MARIA CLAUDIA</option>
<option value="70877-OBREGON SICCHA ROSA PAOLA">OBREGON SICCHA ROSA PAOLA</option>
<option value="78074-OCHOA CAMPOVERDE DIANA MARIZA">OCHOA CAMPOVERDE DIANA MARIZA</option>
<option value="61871-OLIVERA YATACO KATHERINE CINTHYA">OLIVERA YATACO KATHERINE CINTHYA</option>
<option value="79048-OLORTEGUI RAMIREZ JEANETTE GABY">OLORTEGUI RAMIREZ JEANETTE GABY</option>
<option value="80138-ORDO√ëEZ MARTICORENA FIORELLA MINOSKA">ORDO√ëEZ MARTICORENA FIORELLA MINOSKA</option>
<option value="66319-ORTEGA BULNES LESLYE AURORA">ORTEGA BULNES LESLYE AURORA</option>
<option value="74085-ORTIZ FLORES YOLANDA LIDIA">ORTIZ FLORES YOLANDA LIDIA</option>
<option value="79409-OSORIO CUADROS ELIZABETH ROSA">OSORIO CUADROS ELIZABETH ROSA</option>
<option value="73747-PABON AYALA JHON">PABON AYALA JHON</option>
<option value="42377-PALOMINO CAMONES SONIA">PALOMINO CAMONES SONIA</option>
<option value="80282-PAREDES NAVARRO VALERIA DIANNA">PAREDES NAVARRO VALERIA DIANNA</option>
<option value="77068-PARIASCA RIVERA JOSE FRANCISCO">PARIASCA RIVERA JOSE FRANCISCO</option>
<option value="80155-PASAPERA GONZALES PATRICIA IRENE">PASAPERA GONZALES PATRICIA IRENE</option>
<option value="43014-PEDROZO CHUMPITAZ MAGDA GUADALUPE">PEDROZO CHUMPITAZ MAGDA GUADALUPE</option>
<option value="70838-PE√ëA GOMEZ MADELEINE">PE√ëA GOMEZ MADELEINE</option>
<option value="76457-PEREZ DOLORES MARLENY">PEREZ DOLORES MARLENY</option>
<option value="66105-PEREZ MALPARTIDA EVA LUZ">PEREZ MALPARTIDA EVA LUZ</option>
<option value="78486-PEREZ PEZO CRISTINA THALIA">PEREZ PEZO CRISTINA THALIA</option>
<option value="75385-PEREZ SALVATIERRA MANUEL ANTONIO">PEREZ SALVATIERRA MANUEL ANTONIO</option>
<option value="64527-PEREZ U√ëAPILLCO GLORIA KATHERINE">PEREZ U√ëAPILLCO GLORIA KATHERINE</option>
<option value="71994-PISCOYA SARRIN JHONATHAN DARLLY">PISCOYA SARRIN JHONATHAN DARLLY</option>
<option value="79842-PLAZA BOGGIANO JOSE GUILLERMO">PLAZA BOGGIANO JOSE GUILLERMO</option>
<option value="78256-PLAZA SANCHEZ DARIO IGNACIO">PLAZA SANCHEZ DARIO IGNACIO</option>
<option value="29132-POMATAY CHUQUIYAURI NORMA MARIA">POMATAY CHUQUIYAURI NORMA MARIA</option>
<option value="73337-PRADO GUTIERREZ VANESSA ELIZABETH">PRADO GUTIERREZ VANESSA ELIZABETH</option>
<option value="37797-PUERTAS ELGUERA MARGARITA GLADYS">PUERTAS ELGUERA MARGARITA GLADYS</option>
<option value="74326-PUMA HUAMAN NATALY ANDREA">PUMA HUAMAN NATALY ANDREA</option>
<option value="60208-QUEZADA RUIZ SUSANA DEL PILAR">QUEZADA RUIZ SUSANA DEL PILAR</option>
<option value="75450-QUINTANA DOLORIER MARIA ELENA">QUINTANA DOLORIER MARIA ELENA</option>
<option value="79710-QUINTERO CUEVA LUIS BECKAN">QUINTERO CUEVA LUIS BECKAN</option>
<option value="75574-QUIQUIJANA CONDORI JENNIFER ANDREA">QUIQUIJANA CONDORI JENNIFER ANDREA</option>
<option value="77124-QUISPE ALBINO MARIBEL PAULINA">QUISPE ALBINO MARIBEL PAULINA</option>
<option value="79384-QUISPE BELON CARLOS ELISBAN">QUISPE BELON CARLOS ELISBAN</option>
<option value="70860-QUISPE CONTRERAS KATTY">QUISPE CONTRERAS KATTY</option>
<option value="78497-QUISPE GUTIERREZ JERSSON RODRIGO">QUISPE GUTIERREZ JERSSON RODRIGO</option>
<option value="75977-QUISPE GUTIERREZ MAYRA NAYELI">QUISPE GUTIERREZ MAYRA NAYELI</option>
<option value="32822-QUISPE HUAMAN LUZ MARINA">QUISPE HUAMAN LUZ MARINA</option>
<option value="41931-QUISPE OLAVE CARMEN">QUISPE OLAVE CARMEN</option>
<option value="77289-QUISPE ORELLANO JOSELYN YOLANDA">QUISPE ORELLANO JOSELYN YOLANDA</option>
<option value="26093-QUISPE RODAS SILVIA FLOR">QUISPE RODAS SILVIA FLOR</option>
<option value="70960-QUISURUCO SILVA NAPOLY KONOSUKE">QUISURUCO SILVA NAPOLY KONOSUKE</option>
<option value="65639-RACHUMI CORDERO VANESSA DORIS">RACHUMI CORDERO VANESSA DORIS</option>
<option value="50522-RAMIREZ BARBOZA MARIO ISAAC">RAMIREZ BARBOZA MARIO ISAAC</option>
<option value="66785-RAMIREZ BARBOZA SANDY ROMINA">RAMIREZ BARBOZA SANDY ROMINA</option>
<option value="23046-RAMIREZ FLORES DE NU√ëEZ LICELY">RAMIREZ FLORES DE NU√ëEZ LICELY</option>
<option value="70847-RAMIREZ FLORES MIRIAM LILIANA">RAMIREZ FLORES MIRIAM LILIANA</option>
<option value="72874-RAMIREZ MORE MARCOS">RAMIREZ MORE MARCOS</option>
<option value="24475-RAMOS GUEVARA CYNTHIA KATHLEEN">RAMOS GUEVARA CYNTHIA KATHLEEN</option>
<option value="71391-RAMOS ORE ELIZABETH LIZ">RAMOS ORE ELIZABETH LIZ</option>
<option value="76222-RAMOS TOLEDO ABRAHAM JOSUE">RAMOS TOLEDO ABRAHAM JOSUE</option>
<option value="80153-REATEGUI TELLO ELVITA">REATEGUI TELLO ELVITA</option>
<option value="22577-REMICIO RIVAS DE CASTILLO CAROLINA">REMICIO RIVAS DE CASTILLO CAROLINA</option>
<option value="70338-REYES AQUINO ROSARIO OLINDA">REYES AQUINO ROSARIO OLINDA</option>
<option value="71643-REYES PACCORE EDITH MILAGROS">REYES PACCORE EDITH MILAGROS</option>
<option value="78066-REYES RAVELLO RUBY ELIZABETH">REYES RAVELLO RUBY ELIZABETH</option>
<option value="72774-RIOS ADANAQUE NOEMI">RIOS ADANAQUE NOEMI</option>
<option value="72475-RISCO GODOY SAID">RISCO GODOY SAID</option>
<option value="75220-RIVERA EXEBIO LOURDES PATRICIA">RIVERA EXEBIO LOURDES PATRICIA</option>
<option value="68495-RIVERA RAMIREZ ROSA MARIA">RIVERA RAMIREZ ROSA MARIA</option>
<option value="78746-RIVERA SOTELO JHON EMMANUEL">RIVERA SOTELO JHON EMMANUEL</option>
<option value="53784-ROBATTI CALDAS PATRICIA GUILIANA">ROBATTI CALDAS PATRICIA GUILIANA</option>
<option value="80674-ROBLES AVALOS GABRIELA RUTH">ROBLES AVALOS GABRIELA RUTH</option>
<option value="75117-ROBLES PEREZ KATHERYNE JULISSA">ROBLES PEREZ KATHERYNE JULISSA</option>
<option value="75910-ROJAS PORTUGUEZ VIOLETA LIZ">ROJAS PORTUGUEZ VIOLETA LIZ</option>
<option value="81015-ROMERO CUEVA URPI ESPERANZA">ROMERO CUEVA URPI ESPERANZA</option>
<option value="79756-ROMERO MELGAREJO GLORIA MILAGROS">ROMERO MELGAREJO GLORIA MILAGROS</option>
<option value="74742-ROQUE QUEZADA CARMEN MILAGROS">ROQUE QUEZADA CARMEN MILAGROS</option>
<option value="34880-ROSADO BERNAL MANUELA YANINA">ROSADO BERNAL MANUELA YANINA</option>
<option value="44838-RUMICHE RUMICHE MILAGROS MARIBEL">RUMICHE RUMICHE MILAGROS MARIBEL</option>
<option value="44137-SAAVEDRA CUMPA JAVIER">SAAVEDRA CUMPA JAVIER</option>
<option value="80270-SALAS TACSA MELISA CECILIA">SALAS TACSA MELISA CECILIA</option>
<option value="80024-SALCEDO BEJARANO DE ISASI WENDY ELIZABETH">SALCEDO BEJARANO DE ISASI WENDY ELIZABETH</option>
<option value="65524-SALDA√ëA SALAZAR CRISTIAN ALBERTO">SALDA√ëA SALAZAR CRISTIAN ALBERTO</option>
<option value="75879-SALGADO CHAUCA RUBI ANALI">SALGADO CHAUCA RUBI ANALI</option>
<option value="67145-SALINAS BENITES SANDRA VIOLETA">SALINAS BENITES SANDRA VIOLETA</option>
<option value="70945-SALINAS SIMON DELIA ROSA">SALINAS SIMON DELIA ROSA</option>
<option value="76807-SALON INGA ARACELI">SALON INGA ARACELI</option>
<option value="77924-SANCHEZ DE LA CRUZ BIANCA IRAZU">SANCHEZ DE LA CRUZ BIANCA IRAZ√ö</option>
<option value="69676-SANCHEZ DE LA CRUZ MARTIN ALEXIS">SANCHEZ DE LA CRUZ MARTIN ALEXIS</option>
<option value="80925-SANCHEZ DE LA CRUZ MARTINA">SANCHEZ DE LA CRUZ MARTINA</option>
<option value="65363-SANCHEZ QUISPE MOISES JESUS">SANCHEZ QUISPE MOISES JESUS</option>
<option value="75223-SANCHEZ RAMON SEBASTIAN ALEXANDER">SANCHEZ RAMON SEBASTIAN ALEXANDER</option>
<option value="77913-SANCHEZ URPEQUE RAYZA ALEXANDRA">SANCHEZ URPEQUE RAYZA ALEXANDRA</option>
<option value="73422-SANTOS URETA GLADIS ISIDORA">SANTOS URETA GLADIS ISIDORA</option>
<option value="46823-SARE DOMINGUEZ ALBERTO FRANKLIN">SARE DOMINGUEZ ALBERTO FRANKLIN</option>
<option value="30259-SATALAYA SANCHEZ GELHI">SATALAYA SANCHEZ GELHI</option>
<option value="29931-SEGURA CANCHUA MASHELY KRYSTEL">SEGURA CANCHUA MASHELY KRYSTEL</option>
<option value="76843-SEVILLA JIMENEZ PATRICIA IRMA">SEVILLA JIMENEZ PATRICIA IRMA</option>
<option value="64122-SHUPINGAHUA ALVAREZ DE BARRETO JULIANA">SHUPINGAHUA ALVAREZ DE BARRETO JULIANA</option>
<option value="78837-SILENCIO PALACIOS DAVID WASHINGTON">SILENCIO PALACIOS DAVID WASHINGTON</option>
<option value="75681-SILVA UBILLUS ANDRE ARATH">SILVA UBILLUS ANDRE ARATH</option>
<option value="3388-SIMON DURAND DE ZAMORA JESSICA GIOVANNA">SIMON DURAND DE ZAMORA JESSICA GIOVANNA</option>
<option value="77168-SIPAN CARDENAS MIGUEL ANGEL">SIPAN CARDENAS MIGUEL ANGEL</option>
<option value="76609-SOLANO TIPARRA GIANELLA LIZET">SOLANO TIPARRA GIANELLA LIZET</option>
<option value="75284-SOLIS FLORES JOEL ALFREDO ALEJANDRO">SOLIS FLORES JOEL ALFREDO ALEJANDRO</option>
<option value="75482-SOSA AGUILAR GIANELLA DAPHNE">SOSA AGUILAR GIANELLA DAPHNE</option>
<option value="73394-SOTA SOTELO JACKELYN ANGELICA">SOTA SOTELO JACKELYN ANGELICA</option>
<option value="70169-SUAREZ EXEBIO FIORELLA NICOLE">SUAREZ EXEBIO FIORELLA NICOLE</option>
<option value="64125-TANTALEAN CABELLO BETSY DORA">TANTALEAN CABELLO BETSY DORA</option>
<option value="76074-TEJEDA COCA MARIA JOSE">TEJEDA COCA MARIA JOSE</option>
<option value="74683-TINEO MORI MONICA YESSENIA">TINEO MORI MONICA YESSENIA</option>
<option value="70076-TITO CAYO NOEMI LUZ">TITO CAYO NOEMI LUZ</option>
<option value="74449-TITO LUNA MONICA ROSARIO">TITO LUNA MONICA ROSARIO</option>
<option value="70543-TORIBIO PEDRAZA KENNETH GREGORY">TORIBIO PEDRAZA KENNETH GREGORY</option>
<option value="73424-TORRES CONDORI FIORELA JULIA">TORRES CONDORI FIORELA JULIA</option>
<option value="79538-TORRES PALOMINO JOSE ANTONIO">TORRES PALOMINO JOSE ANTONIO</option>
<option value="78777-TORRES TORRES AMY DEANE">TORRES TORRES AMY DEANE</option>
<option value="78778-TORRES TORRES ANGIE LESSLY">TORRES TORRES ANGIE LESSLY</option>
<option value="48543-TRINIDAD ALVAREZ DE MANTILLA LIBERTAD">TRINIDAD ALVAREZ DE MANTILLA LIBERTAD</option>
<option value="79938-URBANO GUERRERO JUAN ALONSO">URBANO GUERRERO JUAN ALONSO</option>
<option value="74255-VALENCIA RODRIGUEZ JOSELYN XIMENA">VALENCIA RODRIGUEZ JOSELYN XIMENA</option>
<option value="21818-VALLADARES REYES VERONICA EMMA">VALLADARES REYES VERONICA EMMA</option>
<option value="73508-VALLADOLID REYNAGA JEFFREY ALDAIR">VALLADOLID REYNAGA JEFFREY ALDAIR</option>
<option value="76759-VALVERDE AGUILAR MARIA LUISA">VALVERDE AGUILAR MARIA LUISA</option>
<option value="66203-VALVERDE PILLPA SHARON GLADYS">VALVERDE PILLPA SHARON GLADYS</option>
<option value="66628-VARGAS CHIRINOS DE SAGASTEGUI MERCEDES SOLEDAD">VARGAS CHIRINOS DE SAGASTEGUI MERCEDES SOLEDAD</option>
<option value="79424-VASQUEZ AGUILAR ROSA MARIBEL">VASQUEZ AGUILAR ROSA MARIBEL</option>
<option value="63848-VASQUEZ ALLCA ERIKA">VASQUEZ ALLCA ERIKA</option>
<option value="12526-VASQUEZ PEREZ LUZ MARIA">VASQUEZ PEREZ LUZ MARIA</option>
<option value="78995-VASQUEZ QUEZADA WILFREDO MANUEL">VASQUEZ QUEZADA WILFREDO MANUEL</option>
<option value="79492-VASQUEZ TROYES YUMALI">VASQUEZ TROYES YUMALI</option>
<option value="80474-VASQUEZ VASQUEZ HAYDEE GERALDINE">VASQUEZ VASQUEZ HAYDEE GERALDINE</option>
<option value="35335-VEGA SORIA NILDA FLOR">VEGA SORIA NILDA FLOR</option>
<option value="64105-VELASQUEZ PAZ ZOILA ROSA">VELASQUEZ PAZ ZOILA ROSA</option>
<option value="71033-VELASQUEZ ROSALES LUZ MARIA">VELASQUEZ ROSALES LUZ MARIA</option>
<option value="78801-VELEZ SARMIENTO RUTH MARTHA">VELEZ SARMIENTO RUTH MARTHA</option>
<option value="80804-VELIZ GUEVARA SUSANA ZARINA">VELIZ GUEVARA SUSANA ZARINA</option>
<option value="77714-VELIZ HUAPAYA ROXANA MARGARITA">VELIZ HUAPAYA ROXANA MARGARITA</option>
<option value="72728-VENEGAS CASTRO PIERO ALONSO">VENEGAS CASTRO PIERO ALONSO</option>
<option value="79016-VIDAL VALERA SANDRA MERCEDES">VIDAL VALERA SANDRA MERCEDES</option>
<option value="67687-VIDAURRE DELGADO MARIA ELIZABETH">VIDAURRE DELGADO MARIA ELIZABETH</option>
<option value="75338-VILCA REYNAGA IMANOL LEANDRO">VILCA REYNAGA IMANOL LEANDRO</option>
<option value="71513-VILELA CHAPO√ëAN BRIZET MARIA">VILELA CHAPO√ëAN BRIZET MARIA</option>
<option value="79849-VILLACORTA ROMERO ROXANA PATRICIA">VILLACORTA ROMERO ROXANA PATRICIA</option>
<option value="63827-VILLANUEVA BARRETO LUCIA VERONICA VANESSA">VILLANUEVA BARRETO LUCIA VERONICA VANESSA</option>
<option value="78608-YAFAC CALERO LUCIA MIA MONSERRAT">YAFAC CALERO LUCIA MIA MONSERRAT</option>
<option value="76890-ZAVALA MUNAYLLA MARIELLA">ZAVALA MUNAYLLA MARIELLA</option>
<option value="34342-ZEGARRA ALVAREZ ILEANA STEPHANIE">ZEGARRA ALVAREZ ILEANA STEPHANIE</option>
<option value="79875-ZU√ëIGA YLLANES MELANIE BRIGITHE">ZU√ëIGA YLLANES MELANIE BRIGITHE</option>
<option value="78116-ZUZUNAGA RIVEROS AMPARO MILAGRITOS">ZUZUNAGA RIVEROS AMPARO MILAGRITOS</option>



            
          </select>
          <div id="agente-search-results" class="search-results" style="display: none;"></div>
        </div>
        <div id="agente_fijado" class="fijado-label">üîí FIJADO</div>
        <div style="margin-top:6px;">
          <button id="fixAgente" class="small-btn notfixed">FIJAR</button>
          <button id="unfixAgente" class="small-btn notfixed" style="margin-left:6px;">NO FIJAR</button>
          <span id="checkAgente" class="check">‚úî</span>
        </div>
      </div>
      <div class="col">
        <label>SUPERVISOR *</label>
        <div id="supervisor-search-container" class="search-container">
          <div class="search-input-wrapper">
            <span class="search-icon">üîç</span>
            <input type="text" id="supervisor-search" class="search-input" placeholder="Buscar supervisor..." autocomplete="off" />
          </div>
          <select id="supervisor" style="display: none;">
            <option value="">Seleccione un supervisor...</option>
            <option value="ALARCON VEGA JORGE">ALARCON VEGA JORGE</option>
            <option value="BARRIENTOS MEJIA KARINA">BARRIENTOS MEJIA KARINA</option>
            <option value="CASTRO NAVARRO RICARDO">CASTRO NAVARRO RICARDO</option>
            <option value="DELGADO CUELLAR VERONICA">DELGADO CUELLAR VERONICA</option>
            <option value="ESCOBAR MIRANDA FERNANDO">ESCOBAR MIRANDA FERNANDO</option>
            <option value="FERNANDEZ RUIZ GLORIA">FERNANDEZ RUIZ GLORIA</option>
          </select>
          <div id="supervisor-search-results" class="search-results" style="display: none;"></div>
        </div>
        <div id="supervisor_fijado" class="fijado-label">üîí FIJADO</div>
        <div style="margin-top:6px;">
          <button id="fixSupervisor" class="small-btn notfixed">FIJAR</button>
          <button id="unfixSupervisor" class="small-btn notfixed" style="margin-left:6px;">NO FIJAR</button>
          <span id="checkSupervisor" class="check">‚úî</span>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>TIPO DE DOCUMENTO *</label>
        <select id="tipoDoc">
          <option value="">Seleccione tipo...</option>
          <option value="DNI">DNI</option>
          <option value="CE">CE</option>
          <option value="CEDULA">CEDULA</option>
          <option value="PASS">PASS</option>
        </select>
        <span id="checkTipoDoc" class="check">‚úî</span>
      </div>
      <div class="col">
        <label>N¬∞ DOCUMENTO *</label>
        <input id="dni" type="text" placeholder="Ingrese n√∫mero de documento" maxlength="8" inputmode="numeric" />
        <span id="checkDni" class="check">‚úî</span>
      </div>
    </div>

    <label>APELLIDOS Y NOMBRES *</label>
    <input id="nombres" type="text" readonly placeholder="Se autocompleta con DNI (si existe)" />
    <span id="checkNombres" class="check">‚úî</span>

    <div class="row">
      <div class="col">
        <label>FECHA DE NACIMIENTO *</label>
        <input id="fechaNacimiento" type="date" />
        <span id="checkFechaNacimiento" class="check">‚úî</span>
      </div>
      <div class="col">
        <label>SEXO *</label>
        <select id="sexo">
          <option value="">Seleccione</option>
          <option value="MASCULINO">MASCULINO</option>
          <option value="FEMENINO">FEMENINO</option>
        </select>
        <span id="checkSexo" class="check">‚úî</span>
      </div>
    </div>

    <div class="row">
      <div class="col">
        <label>IPRESS *</label>
        <div id="ipress-search-container" class="search-container">
          <div class="search-input-wrapper">
            <span class="search-icon">üîç</span>
            <input type="text" id="ipress-search" class="search-input" placeholder="Buscar IPRESS..." autocomplete="off" />
          </div>
          <select id="ipress" required style="display: none;">
            <option value="">Seleccione IPRESS...</option>
            <option value="C.M. ANCIJE">C.M. ANCIJE</option>
            <option value="C.M. MALA">C.M. MALA</option>
            <option value="CAP II CHANCAY">CAP II CHANCAY</option>
            <option value="CAP II LUR√çN">CAP II LUR√çN</option>
            <option value="CAP III ALFREDO PIAZZA ROBERTS">CAP III ALFREDO PIAZZA ROBERTS</option>
            <option value="CAP III CARABAYLLO">CAP III CARABAYLLO</option>
            <option value="CAP III EL AGUSTINO">CAP III EL AGUSTINO</option>
            <option value="CAP III HNA. MARIA DONROSE SUTMOLLER">CAP III HNA. MARIA DONROSE SUTMOLLER</option>
            <option value="CAP III HUARAL">CAP III HUARAL</option>
            <option value="CAP III HUAYCAN">CAP III HUAYCAN</option>
            <option value="CAP III INDEPENDENCIA">CAP III INDEPENDENCIA</option>
            <option value="CAP III LUIS NEGREIROS VEGA">CAP III LUIS NEGREIROS VEGA</option>
            <option value="CAP III METROPOLITANO CALLAO">CAP III METROPOLITANO CALLAO</option>
            <option value="CAP III PEDRO REYES BARBOZA">CAP III PEDRO REYES BARBOZA</option>
            <option value="CAP III PUENTE PIEDRA">CAP III PUENTE PIEDRA</option>
            <option value="CAP III SAN ISIDRO">CAP III SAN ISIDRO</option>
            <option value="CAP III SAN JUAN DE MIRAFLORES">CAP III SAN JUAN DE MIRAFLORES</option>
            <option value="CAP III SURQUILLO">CAP III SURQUILLO</option>
            <option value="H.I AURELIO DIAZ-UFANO Y PERAL">H.I AURELIO DIAZ-UFANO Y PERAL</option>
            <option value="H.I CARLOS ALCANTARA BUTTERFIELD">H.I CARLOS ALCANTARA BUTTERFIELD</option>
            <option value="H.I JORGE VOTO BERNALES CORPANCHO">H.I JORGE VOTO BERNALES CORPANCHO</option>
            <option value="H.I MARINO MOLINA SCIPPA">H.I MARINO MOLINA SCIPPA</option>
            <option value="H.I OCTAVIO MONGRUT MU√ëOZ">H.I OCTAVIO MONGRUT MU√ëOZ</option>
            <option value="H.I ULDARICO ROCCA FERNANDEZ">H.I ULDARICO ROCCA FERNANDEZ</option>
            <option value="H.II CA√ëETE">H.II CA√ëETE</option>
            <option value="H.II GUSTAVO LANATTA LUJAN">H.II GUSTAVO LANATTA LUJAN</option>
            <option value="H.II LIMA NORTE - CALLAO L. NEGREIROS V.">H.II LIMA NORTE - CALLAO L. NEGREIROS V.</option>
            <option value="H.II RAMON CASTILLA">H.II RAMON CASTILLA</option>
            <option value="H.II VITARTE">H.II VITARTE</option>
            <option value="H.III HOSPITAL DE EMERGENCIAS GRAU">H.III HOSPITAL DE EMERGENCIAS GRAU</option>
            <option value="H.III SUAREZ-ANGAMOS">H.III SUAREZ-ANGAMOS</option>
            <option value="H.N. ALBERTO SABOGAL SOLOGUREN">H.N. ALBERTO SABOGAL SOLOGUREN</option>
            <option value="H.N. EDGARDO REBAGLIATI MARTINS">H.N. EDGARDO REBAGLIATI MARTINS</option>
            <option value="IPRESS CLINICA SAN BARTOLOME - HUACHO">IPRESS CLINICA SAN BARTOLOME - HUACHO</option>
            <option value="IPRESS CLINICA SAN PEDRO">IPRESS CLINICA SAN PEDRO</option>
            <option value="IPRESS SAN MARTIN DE PORRES">IPRESS SAN MARTIN DE PORRES</option>
            <option value="POL. CHINCHA">POL. CHINCHA</option>
            <option value="POL. CHOSICA">POL. CHOSICA</option>
            <option value="POL. COMPLEJIDAD CRECIENTE SAN NICOLAS">POL. COMPLEJIDAD CRECIENTE SAN NICOLAS</option>
            <option value="POL. FIORI">POL. FIORI</option>
            <option value="POL. FRANCISCO PIZARRO">POL. FRANCISCO PIZARRO</option>
            <option value="POL. JUAN JOSE RODRIGUEZ LAZO">POL. JUAN JOSE RODRIGUEZ LAZO</option>
            <option value="POL. PABLO BERMUDEZ">POL. PABLO BERMUDEZ</option>
            <option value="POL. PROCERES">POL. PROCERES</option>
            <option value="POL. SAN LUIS">POL. SAN LUIS</option>
            <option value="POL. SANTA CRUZ">POL. SANTA CRUZ</option>
            <option value="POLICLINICO BAYOVAR">POLICLINICO BAYOVAR</option>
            <option value="POLICLINICO SAN CARLOS">POLICLINICO SAN CARLOS</option>
            <option value="RETABLO - COMAS">RETABLO - COMAS</option>
          </select>
          <div id="ipress-search-results" class="search-results" style="display: none;"></div>
        </div>
        <span id="checkIpress" class="check">‚úî</span>
      </div>
      <div class="col">
        <label>ESPECIALIDAD *</label>
        <div id="espe-search-container" class="search-container">
          <div class="search-input-wrapper">
            <span class="search-icon">üîç</span>
            <input type="text" id="espe-search" class="search-input" placeholder="Buscar especialidad..." autocomplete="off" />
          </div>
          <select id="espe" style="display: none;">
            <option value="">Seleccione especialidad...</option>
            <option value="MEDICINA GENERAL">MEDICINA GENERAL</option>
            <option value="PEDIATR√çA">PEDIATR√çA</option>
            <option value="GINECOLOG√çA Y OBSTETRICIA">GINECOLOG√çA Y OBSTETRICIA</option>
            <option value="CARDIOLOG√çA">CARDIOLOG√çA</option>
            <option value="NEUROLOG√çA">NEUROLOG√çA</option>
            <option value="PSIQUIATR√çA">PSIQUIATR√çA</option>
            <option value="TRAUMATOLOG√çA">TRAUMATOLOG√çA</option>
            <option value="DERMATOLOG√çA">DERMATOLOG√çA</option>
            <option value="ENDOCRINOLOG√çA">ENDOCRINOLOG√çA</option>
            <option value="NEFROLOG√çA">NEFROLOG√çA</option>
            <option value="ONCOLOG√çA">ONCOLOG√çA</option>
            <option value="OFTALMOLOG√çA">OFTALMOLOG√çA</option>
            <option value="OTORRINOLARINGOLOG√çA">OTORRINOLARINGOLOG√çA</option>
            <option value="UROLOG√çA">UROLOG√çA</option>
            <option value="OTRA">OTRA</option>
          </select>
          <div id="espe-search-results" class="search-results" style="display: none;"></div>
        </div>
        <span id="checkEspe" class="check">‚úî</span>
      </div>
    </div>

    <label>OBSERVACI√ìN * <small style="font-weight:normal;color:#777;">(*) obligatorio</small></label>
    <select id="obsSelect">
      <option value="">Seleccione motivo...</option>
      <option value="HISTORIA CLINICA BLOQUEADA">HISTORIA CLINICA BLOQUEADA</option>
      <option value="NO CUENTA CON VIGENCIA DE ATENCI√ìN">NO CUENTA CON VIGENCIA DE ATENCI√ìN</option>
      <option value="NO SE CUENTA CON CITAS DISPONIBLES">NO SE CUENTA CON CITAS DISPONIBLES</option>
      <option value="NO SE CUENTA CON PROGRAMACI√ìN DISPONIBLE">NO SE CUENTA CON PROGRAMACI√ìN DISPONIBLE</option>
      <option value="EEL NO OTORGA CITAS A PACIENTES REFERIDOS">EEL NO OTORGA CITAS A PACIENTES REFERIDOS</option>
      <option value="EEL NO OTORGA CITAS DE ESPECIALIDADES EN ALGUNAS IPRESS">EEL NO OTORGA CITAS DE ESPECIALIDADES EN ALGUNAS IPRESS</option>
      <option value="NO HAY CITAS DISPONIBLES DE TELECONSULTA">NO HAY CITAS DISPONIBLES DE TELECONSULTA</option>
      <option value="PACIENTE ADSCRITO A PROVINCIA">PACIENTE ADSCRITO A PROVINCIA</option>
    </select>
    <span id="checkObs" class="check">‚úî</span>
    <textarea id="obs" placeholder="Detalles adicionales (si aplica)..." style="margin-top:6px;display:none;"></textarea>

    <div class="row">
      <div class="col">
        <label>CELULAR 1 *</label>
        <input id="cel1" type="tel" placeholder="Ej: 987654321" maxlength="9" inputmode="numeric" />
        <span id="checkCel1" class="check">‚úî</span>
      </div>
      <div class="col">
        <label>CELULAR 2 (CONTINGENCIA)</label>
        <input id="cel2" type="tel" placeholder="Opcional" maxlength="9" inputmode="numeric" />
        <span id="checkCel2" class="check">‚úî</span>
      </div>
    </div>

    <div class="btns">
      <button class="btn secondary" id="btnNuevo">NUEVO REGISTRO</button>
      <button class="btn" id="btnGuardar">GUARDAR</button>
    </div>

    <p class="note">‚úÖ Todos los campos con * son obligatorios. Datos se env√≠an a Google Sheets.</p>
  </div>
</div>

<script>
const $ = id => document.getElementById(id);

// üîë TU URL DE GOOGLE APPS SCRIPT ‚Äî YA CONFIGURADA
const SHEETS_URL = "https://script.google.com/macros/s/AKfycbx9Zjjr3Jp-P-K0dJ2HNq0FowC5uEdQixxIGiQ6YWRbB30WHrqa8YPd8OaVDKNhgyZU/exec";

/* Mostrar/Ocultar textarea seg√∫n selecci√≥n de observaci√≥n */
$('obsSelect').addEventListener('change', function(){
  const textarea = $('obs');
  if(this.value === 'OTRO'){
    textarea.style.display = 'block';
    textarea.focus();
  } else {
    textarea.style.display = 'none';
    textarea.value = '';
  }
});

/* Fecha / hora */
function formatoAmigable(date){
  const opts = { weekday:'long', day:'2-digit', month:'long',
                hour:'2-digit', minute:'2-digit', second:'2-digit',
                hour12:false, timeZone:'America/Lima' };
  const texto = date.toLocaleString('es-PE', opts);
  return texto.charAt(0).toUpperCase() + texto.slice(1);
}
function actualizarRegistro(){ $('registro').innerText = formatoAmigable(new Date()); }
setInterval(actualizarRegistro,1000);
actualizarRegistro();

/* ‚úÖ Fijar / no fijar + animaci√≥n pulse */
function applyFijadoVisual(id, isFixed){
  const input = $(id);
  const fijadoLabel = $(id + '_fijado');
  const btnCheck = $('check' + capitalizeId(id));
  const fixBtn = (id === 'agente') ? $('fixAgente') : $('fixSupervisor');
  const unfixBtn = (id === 'agente') ? $('unfixAgente') : $('unfixSupervisor');
  if(isFixed){
    fijadoLabel.classList.add('fijado-visible');
    fixBtn.classList.remove('notfixed'); fixBtn.classList.add('fixed');
    unfixBtn.classList.remove('fixed'); unfixBtn.classList.add('notfixed');
    btnCheck.classList.add('visible');
    input.style.animation = 'pulseSuccess 0.4s, bounce 0.6s 0.2s ease';
    setTimeout(() => input.style.animation = '', 1000);
  } else {
    fijadoLabel.classList.remove('fijado-visible');
    fixBtn.classList.remove('fixed'); fixBtn.classList.add('notfixed');
    unfixBtn.classList.remove('notfixed');
    btnCheck.classList.remove('visible');
  }
}
function capitalizeId(id){ return id.charAt(0).toUpperCase() + id.slice(1); }
function fijarCampo(id,key){ 
  const val=$(id).value.trim(); 
  if(!val){ 
    alert('Seleccione un valor antes de fijar.'); 
    return; 
  } 
  localStorage.setItem(key,val); 
  applyFijadoVisual(id,true); 
}
function nofijarCampo(id,key){ 
  localStorage.removeItem(key); 
  applyFijadoVisual(id,false); 
}
$('fixAgente').addEventListener('click', ()=> fijarCampo('agente','AGENTE'));
$('unfixAgente').addEventListener('click', ()=> nofijarCampo('agente','AGENTE'));
$('fixSupervisor').addEventListener('click', ()=> fijarCampo('supervisor','SUPERVISOR'));
$('unfixSupervisor').addEventListener('click', ()=> nofijarCampo('supervisor','SUPERVISOR'));

window.addEventListener('load',()=>{
  const ag=localStorage.getItem('AGENTE'); 
  const sp=localStorage.getItem('SUPERVISOR');
  if(ag){ 
    $('agente').value=ag; 
    applyFijadoVisual('agente',true);
  }
  if(sp){ 
    $('supervisor').value=sp; 
    applyFijadoVisual('supervisor',true);
  }
});

/* ‚úÖ Funciones de estado visual */
function showStatusMsg(input, text, type) {
  const prev = input.nextElementSibling;
  if(prev && prev.classList.contains('status-msg')) prev.remove();
  const span = document.createElement('span');
  span.className = `status-msg ${type}`;
  span.textContent = text;
  input.parentNode.insertBefore(span, input.nextSibling);
}

function showSuccessField(inputId, msg = "‚úî Listo") {
  const input = $(inputId);
  if(!input) return;
  input.classList.remove('error-field', 'incomplete');
  input.classList.add('success');
  showStatusMsg(input, msg, 'success');
  setTimeout(() => input.classList.remove('success'), 1500);
}

function showWarningField(inputId, msg = "‚ö† Incompleto") {
  const input = $(inputId);
  if(!input) return;
  input.classList.remove('success', 'error-field');
  input.classList.add('incomplete');
  showStatusMsg(input, msg, 'warning');
}

function showErrorField(inputId, msg = "‚úò Inv√°lido") {
  const input = $(inputId);
  if(!input) return;
  input.classList.remove('success', 'incomplete');
  input.classList.add('error-field');
  showStatusMsg(input, msg, 'error');
}

function clearFieldStatus(inputId) {
  const input = $(inputId);
  if(!input) return;
  input.classList.remove('success', 'incomplete', 'error-field');
  const msg = input.nextElementSibling;
  if(msg && msg.classList.contains('status-msg')) msg.remove();
}

/* DNI */
$('dni').addEventListener('input', function(){
  this.value = this.value.replace(/\D/g, '').slice(0,8);
});
$('dni').addEventListener('blur', function(){
  const val = this.value.trim();
  if(val && val.length === 8) {
    this.value = val.padStart(8, '0');
    clearFieldStatus('dni');
  } else if(val) {
    showWarningField('dni', '‚ö† Ingrese 8 d√≠gitos');
  }
});

/* Buscar DNI */
async function buscarDNI(dni){
  const url = `http://172.20.60.152:8000/buscar/${encodeURIComponent(dni)}`;
  try{
    const resp = await fetch(url, { timeout: 5000 });
    if(!resp.ok){ 
      $('nombres').value = ''; 
      $('nombres').readOnly = false;
      return; 
    }
    const data = await resp.json();

    const normalize = obj => {
      const keys = {};
      for(let k in obj) keys[k.toLowerCase()] = obj[k];
      return keys;
    };
    const d = normalize(data);

    const nombreCompleto = d.nombre_completo || d.apellidos_nombres || 
      (d.apellido_paterno && d.apellido_materno && d.nombres 
        ? `${d.apellido_paterno} ${d.apellido_materno} ${d.nombres}` : null) || null;
    $('nombres').value = nombreCompleto ? String(nombreCompleto).toUpperCase() : '';
    $('nombres').readOnly = !!nombreCompleto;

    let fechaNac = d.fecha_nacimiento || d.fecha_nac || d.fechanac;
    if(fechaNac && typeof fechaNac === 'string'){
      const parts = fechaNac.split(/[\/\-]/);
      if(parts.length === 3){
        const [d,m,y] = parts[0].length <= 2 ? [parts[0], parts[1], parts[2]] : [parts[2], parts[1], parts[0]];
        if(y && m && d) {
          fechaNac = `${y.padStart(4,'0')}-${m.padStart(2,'0')}-${d.padStart(2,'0')}`;
          $('fechaNacimiento').value = fechaNac;
          showSuccessField('fechaNacimiento', '‚úî Fecha cargada');
        }
      }
    }

    const sexoVal = d.sexo || d.genero || '';
    if(/masculino|m/i.test(String(sexoVal))) {
      $('sexo').value = 'MASCULINO';
      showSuccessField('sexo', '‚úî Sexo cargado');
    } else if(/femenino|f/i.test(String(sexoVal))) {
      $('sexo').value = 'FEMENINO';
      showSuccessField('sexo', '‚úî Sexo cargado');
    }

    if(nombreCompleto) {
      showSuccessField('nombres', '‚úî Nombre cargado');
    }
    $('checkDni').classList.add('visible');
    setTimeout(() => $('checkDni').classList.remove('visible'), 2000);

  }catch(err){ 
    $('nombres').value = '';
    $('nombres').readOnly = false;
    $('fechaNacimiento').value = '';
    $('sexo').value = '';
  }
}

let debounce;
$('dni').addEventListener('input', function(){
  clearTimeout(debounce);
  const val = this.value.trim();
  if(val.length >= 7){ 
    debounce = setTimeout(()=>buscarDNI(val.padStart(8,'0')), 450);
  } else {
    $('nombres').value = '';
    $('nombres').readOnly = false;
    $('fechaNacimiento').value = '';
    $('sexo').value = '';
    ['nombres','fechaNacimiento','sexo'].forEach(id => clearFieldStatus(id));
  }
});
$('dni').addEventListener('keydown',(e)=>{ 
  if(e.key==='Enter'){ 
    e.preventDefault(); 
    const dni = $('dni').value.trim();
    if(dni && dni.length === 8) {
      buscarDNI(dni.padStart(8,'0'));
    } else {
      showWarningField('dni', '‚ö† Ingrese 8 d√≠gitos');
    }
  } 
});

// Celulares
function validarCelular(inputId, checkId) {
  const input = $(inputId);
  const val = input.value.replace(/\D/g, '').slice(0,9);
  input.value = val;
  if(val.length >= 7 && /^\d{7,9}$/.test(val)){
    showSuccessField(inputId, '‚úî Celular v√°lido');
    const chk = $(checkId);
    chk.classList.add('visible');
    setTimeout(() => chk.classList.remove('visible'), 2000);
  }
}
$('cel1').addEventListener('input', () => validarCelular('cel1', 'checkCel1'));
$('cel2').addEventListener('input', () => validarCelular('cel2', 'checkCel2'));

// ‚úÖ Activar check inmediato en select (IPRESS, ESPECIALIDAD, OBS)
['ipress', 'espe', 'obsSelect', 'agente', 'supervisor', 'tipoDoc', 'sexo'].forEach(id => {
  const el = $(id);
  if (el) {
    el.addEventListener('change', function() {
      const val = this.value.trim();
      if (val) {
        showSuccessField(id, '‚úî Listo');
        const chk = $('check' + id.charAt(0).toUpperCase() + id.slice(1));
        if (chk) {
          chk.classList.add('visible');
          setTimeout(() => chk.classList.remove('visible'), 2000);
        }
      } else {
        clearFieldStatus(id);
      }
    });
  }
});

// Nuevo registro
$('btnNuevo').addEventListener('click',function(e){ 
  e.preventDefault();
  const agF = localStorage.getItem('AGENTE');
  const spF = localStorage.getItem('SUPERVISOR');
  
  ['dni','nombres','fechaNacimiento','sexo','ipress','espe','obsSelect','obs','cel1','cel2'].forEach(id=>{
    const el = $(id);
    if(el) {
      if(el.tagName === 'SELECT') {
        el.selectedIndex = 0;
        if(id === 'obsSelect') $('obs').style.display = 'none';
      } else {
        el.value = '';
      }
    }
  });
  
  if(agF) $('agente').value = agF;
  if(spF) $('supervisor').value = spF;
  
  document.querySelectorAll('.status-msg').forEach(el => el.remove());
  document.querySelectorAll('input, select').forEach(el => {
    el.classList.remove('success', 'incomplete', 'error-field');
  });
  actualizarRegistro(); 
});

// ‚úÖ VALIDACI√ìN FINAL: TODOS OBLIGATORIOS EXCEPTO CELULAR 2
function validateForm() {
  const checks = [
    {id: 'agente', valid: v => v.trim(), msg: 'Agente obligatorio'},
    {id: 'supervisor', valid: v => v.trim(), msg: 'Supervisor obligatorio'},
    {id: 'tipoDoc', valid: v => v.trim(), msg: 'Tipo de documento obligatorio'},
    {id: 'dni', valid: v => v.trim().length === 8, msg: 'DNI: 8 d√≠gitos'},
    {id: 'nombres', valid: v => v.trim(), msg: 'Nombre obligatorio'},
    {id: 'fechaNacimiento', valid: v => v.trim(), msg: 'Fecha de nacimiento obligatoria'},
    {id: 'sexo', valid: v => v.trim(), msg: 'Sexo obligatorio'},
    {id: 'ipress', valid: v => v.trim(), msg: 'IPRESS obligatoria'},
    {id: 'espe', valid: v => v.trim(), msg: 'Especialidad obligatoria'},
    {id: 'obsSelect', valid: v => v.trim(), msg: 'Motivo de observaci√≥n obligatorio'}
  ];

  let firstError = null;

  checks.forEach(({id, valid, msg}) => {
    const el = $(id);
    const val = el ? el.value : '';
    if(el && !valid(val)) {
      showErrorField(id, `‚úò ${msg}`);
      if(!firstError) firstError = el;
    } else if(el) {
      clearFieldStatus(id);
    }
  });

  const obsSelect = $('obsSelect');
  const obsTextarea = $('obs');
  if (obsSelect.value === 'OTRO') {
    const obsVal = obsTextarea.value.trim();
    if (!obsVal) {
      showErrorField('obs', '‚úò Detalle obligatorio (motivo: OTRO)');
      if (!firstError) firstError = obsTextarea;
    } else {
      clearFieldStatus('obs');
    }
  } else {
    clearFieldStatus('obs');
  }

  const cel1Val = $('cel1').value.replace(/\D/g, '');
  if (!/^\d{7,9}$/.test(cel1Val)) {
    showErrorField('cel1', '‚úò CELULAR 1: 7-9 d√≠gitos');
    if (!firstError) firstError = $('cel1');
  } else {
    clearFieldStatus('cel1');
  }

  if (firstError) {
    firstError.scrollIntoView({ behavior: 'smooth', block: 'center' });
    setTimeout(() => firstError.focus(), 300);
  }

  return firstError;
}

// üì§ ENVIAR A GOOGLE SHEETS
async function enviarAGoogleSheets() {
  const data = {
    Agente: $('agente').value,
    Supervisor: $('supervisor').value,
    TipoDoc: $('tipoDoc').value,
    DNI: $('dni').value.padStart(8, '0'),
    Nombres: $('nombres').value,
    FechaNac: $('fechaNacimiento').value,
    Sexo: $('sexo').value,
    IPRESS: $('ipress').value,
    Especialidad: $('espe').value,
    Observacion: $('obsSelect').value,
    ObsDetalle: $('obs').value,
    Celular1: $('cel1').value,
    Celular2: $('cel2').value || ''
  };

  try {
    // Usa mode: 'no-cors' para evitar errores con Google
    const response = await fetch(SHEETS_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    // Como no-cors no devuelve respuesta, asumimos √©xito si no hay error de red
    return { success: true };
  } catch (err) {
    return { error: true, message: err.message };
  }
}

// Toast de √©xito/error
function showToast(message, isSuccess = true) {
  const color = isSuccess ? '#28a745' : '#e74c3c';
  const toast = document.createElement('div');
  toast.innerHTML = `
    <div style="
      position:fixed; top:20px; right:20px; 
      background:${color}; color:white; 
      padding:14px 24px; border-radius:8px; 
      box-shadow:0 6px 20px rgba(0,0,0,0.2);
      font-weight:700; z-index:10000;
      animation: slideIn 0.4s, fadeOut 0.4s 2.6s;
    ">
      ${isSuccess ? '‚úîÔ∏è' : '‚ùå'} ${message}
    </div>
  `;
  document.body.appendChild(toast);
  setTimeout(() => toast.remove(), 3000);
}

// Guardar + Enviar
$('btnGuardar').addEventListener('click', async function(e){
  e.preventDefault();

  document.querySelectorAll('.status-msg').forEach(el => el.remove());

  const firstError = validateForm();
  if(firstError) return;

  // üü° Activar estado de carga
  const btn = $('btnGuardar');
  btn.classList.add('loading');
  btn.disabled = true;

  // ‚ú® Mostrar √©xito local primero
  [
    'agente','supervisor','tipoDoc','dni','nombres','fechaNacimiento','sexo',
    'ipress','espe','obsSelect','cel1'
  ].forEach(id => showSuccessField(id, '‚úî Listo'));
  
  if($('obsSelect').value === 'OTRA' || $('obsSelect').value === 'OTRO') showSuccessField('obs', '‚úî Detalle agregado');
  if($('cel2').value.trim()) showSuccessField('cel2', '‚úî Listo');

  // üì§ Enviar a Google Sheets
  const result = await enviarAGoogleSheets();

  // üü¢/üî¥ Actualizar bot√≥n y mostrar resultado
  setTimeout(() => {
    btn.classList.remove('loading');
    btn.disabled = false;

    if (result.success) {
      showToast("Registro guardado en Google Sheets ‚úÖ");
      
      // Limpiar tras √©xito
      setTimeout(() => {
        const agF = localStorage.getItem('AGENTE');
        const spF = localStorage.getItem('SUPERVISOR');
        
        ['dni','nombres','fechaNacimiento','sexo','ipress','espe','obsSelect','cel1','cel2'].forEach(id=>{
          const el = $(id);
          if(el) {
            if(el.tagName === 'SELECT') el.selectedIndex = 0;
            else el.value = '';
          }
        });
        $('obs').value = '';
        $('obs').style.display = 'none';
        
        if(agF) $('agente').value = agF;
        if(spF) $('supervisor').value = spF;
        
        actualizarRegistro();
      }, 1200);
    } else {
      showErrorField('registro', '‚úò Error al enviar a Sheets');
      showToast("Error de red: " + (result.message || "Verifica conexi√≥n"), false);
    }
  }, 800);
});

// ====================
// üîç FUNCIONES DEL BUSCADOR
// ====================

// Funci√≥n para inicializar el buscador en un campo
function initSearcher(searchInputId, selectId, searchResultsId) {
  const searchInput = $(searchInputId);
  const select = $(selectId);
  const searchResults = $(searchResultsId);
  const originalOptions = Array.from(select.options).map(opt => ({ value: opt.value, text: opt.text }));
  
  // Mostrar resultados al escribir
  searchInput.addEventListener('input', function() {
    const query = this.value.trim().toLowerCase();
    
    if (query.length === 0) {
      searchResults.style.display = 'none';
      return;
    }
    
    const filteredOptions = originalOptions.filter(opt => 
      opt.text.toLowerCase().includes(query) || opt.value.toLowerCase().includes(query)
    );
    
    // Limpiar resultados
    searchResults.innerHTML = '';
    
    if (filteredOptions.length === 0) {
      const noResults = document.createElement('div');
      noResults.className = 'search-no-results';
      noResults.textContent = 'No se encontraron resultados';
      searchResults.appendChild(noResults);
    } else {
      filteredOptions.forEach(opt => {
        const item = document.createElement('div');
        item.className = 'search-result-item';
        item.textContent = opt.text;
        item.dataset.value = opt.value;
        item.addEventListener('click', function() {
          select.value = opt.value;
          searchInput.value = opt.text;
          searchResults.style.display = 'none';
          // Disparar evento change para mantener la funcionalidad existente
          select.dispatchEvent(new Event('change'));
        });
        searchResults.appendChild(item);
      });
    }
    
    searchResults.style.display = 'block';
  });
  
  // Mostrar todos los resultados al hacer clic en el input
  searchInput.addEventListener('focus', function() {
    if (this.value.trim().length === 0) {
      searchResults.innerHTML = '';
      originalOptions.forEach(opt => {
        const item = document.createElement('div');
        item.className = 'search-result-item';
        item.textContent = opt.text;
        item.dataset.value = opt.value;
        item.addEventListener('click', function() {
          select.value = opt.value;
          searchInput.value = opt.text;
          searchResults.style.display = 'none';
          select.dispatchEvent(new Event('change'));
        });
        searchResults.appendChild(item);
      });
      searchResults.style.display = 'block';
    }
  });
  
  // Ocultar resultados al hacer clic fuera
  document.addEventListener('click', function(e) {
    if (!searchInput.contains(e.target) && !searchResults.contains(e.target)) {
      searchResults.style.display = 'none';
    }
  });
  
  // Seleccionar elemento con teclas de flecha y Enter
  searchInput.addEventListener('keydown', function(e) {
    if (e.key === 'ArrowDown' || e.key === 'ArrowUp') {
      e.preventDefault();
      const items = Array.from(searchResults.querySelectorAll('.search-result-item'));
      if (items.length === 0) return;
      
      let currentIndex = -1;
      const selectedItem = searchResults.querySelector('.search-result-item.selected');
      if (selectedItem) {
        currentIndex = items.indexOf(selectedItem);
      }
      
      if (e.key === 'ArrowDown') {
        currentIndex = (currentIndex + 1) % items.length;
      } else if (e.key === 'ArrowUp') {
        currentIndex = (currentIndex - 1 + items.length) % items.length;
      }
      
      items.forEach((item, index) => {
        item.classList.toggle('selected', index === currentIndex);
      });
      
      // Scroll al elemento seleccionado
      if (currentIndex >= 0) {
        items[currentIndex].scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }
    } else if (e.key === 'Enter') {
      e.preventDefault();
      const selectedItem = searchResults.querySelector('.search-result-item.selected');
      if (selectedItem) {
        select.value = selectedItem.dataset.value;
        searchInput.value = selectedItem.textContent;
        searchResults.style.display = 'none';
        select.dispatchEvent(new Event('change'));
      }
    }
  });
}

// Inicializar buscadores para los campos especificados
initSearcher('agente-search', 'agente', 'agente-search-results');
initSearcher('supervisor-search', 'supervisor', 'supervisor-search-results');
initSearcher('ipress-search', 'ipress', 'ipress-search-results');
initSearcher('espe-search', 'espe', 'espe-search-results');

// Sincronizar el valor del select con el input de b√∫squeda cuando cambia manualmente
document.addEventListener('DOMContentLoaded', function() {
  // Para agente
  $('agente').addEventListener('change', function() {
    const searchInput = $('agente-search');
    const selectedOption = this.options[this.selectedIndex];
    if (selectedOption.value !== '') {
      searchInput.value = selectedOption.text;
    } else {
      searchInput.value = '';
    }
  });
  
  // Para supervisor
  $('supervisor').addEventListener('change', function() {
    const searchInput = $('supervisor-search');
    const selectedOption = this.options[this.selectedIndex];
    if (selectedOption.value !== '') {
      searchInput.value = selectedOption.text;
    } else {
      searchInput.value = '';
    }
  });
  
  // Para ipress
  $('ipress').addEventListener('change', function() {
    const searchInput = $('ipress-search');
    const selectedOption = this.options[this.selectedIndex];
    if (selectedOption.value !== '') {
      searchInput.value = selectedOption.text;
    } else {
      searchInput.value = '';
    }
  });
  
  // Para especialidad
  $('espe').addEventListener('change', function() {
    const searchInput = $('espe-search');
    const selectedOption = this.options[this.selectedIndex];
    if (selectedOption.value !== '') {
      searchInput.value = selectedOption.text;
    } else {
      searchInput.value = '';
    }
  });
});

</script>

</body>
</html>


